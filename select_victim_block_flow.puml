@startuml select_victim_block_flow
start
if (blocks == NULL
or block_count == 0) then (yes)
  :return NULL;
  stop
else (no)
  :best_block <- NULL;
  :min_cost <- DBL_MAX;
  :i <- 0;
  while (i < block_count?)
    :candidate <- blocks[i];
    :total_cost <- compute_cost(candidate,
                                erase_count_max,
                                wl_weight);
    note right
      compute_cost normalizes erase count,
      penalizes higher wear, and avoids division by zero.
    end note
    if (total_cost < min_cost?) then (yes)
      :min_cost <- total_cost;
      :best_block <- candidate;
    endif
    :i <- i + 1;
  endwhile
  :return best_block;
  stop
endif
@enduml